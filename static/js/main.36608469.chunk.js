(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{230:function(e,t,n){e.exports=n(292)},235:function(e,t,n){},292:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(11),c=n.n(i),o=(n(235),n(221)),l=n(51),s=n(224),u=n(28),m=!1,p=function(e,t){switch(t.type){case"setLines":m=!0;var n=t.data.LinesDelivery.AnnotatedLineRef.map(function(e){return{LineRef:e.LineRef,LineName:e.LineName,RouteType:e.Extension.RouteType}});return e.stops.length>0&&(m=!1),Object(u.a)({},e,{lines:n,loading:m});case"setStops":m=!0;var a=[],r={};return t.data.ServiceDelivery.EstimatedTimetableDelivery.map(function(e){return e.EstimatedJourneyVersionFrame.map(function(e){return e.EstimatedVehicleJourney.map(function(e){var t=e.LineRef,n=e.DirectionRef,i=e.Extension.VehicleMode;return e.EstimatedCalls.map(function(e){return!r[e.StopPointRef]&&(a.push({LineRef:t,DirectionRef:n,StopPointRef:e.StopPointRef,StopPointName:e.StopPointName,DestinationName:e.DestinationName,VehicleMode:i}),r[e.StopPointRef]=!0,!1)}),!1}),!1}),!1}),e.lines.length>0&&(m=!1),Object(u.a)({},e,{stops:a,loading:m});case"VehicleModeFilter":var i=e.VehicleMode;return i[t.data.mode]=t.data.checked,Object(u.a)({},e,{VehicleMode:i});case"LineSelection":return Object(u.a)({},e,{line:t.data.line});case"StopSelection":return Object(u.a)({},e,{stop:t.data.stop});case"DateSelection":return Object(u.a)({},e,{date:t.data.date});case"Search":var c=[];return"undefined"===typeof t.data.ServiceDelivery.StopMonitoringDelivery[0].MonitoredStopVisit?Object(u.a)({},e,{results:c}):(t.data.ServiceDelivery.StopMonitoringDelivery[0].MonitoredStopVisit.map(function(e){var t=e.MonitoredVehicleJourney,n=t.MonitoredCall;return c.push({DestinationName:t.DestinationName,LineRef:t.LineRef,VehicleMode:t.VehicleMode,IsRealTime:n.Extension.IsRealTime,StopPointName:n.StopPointName,ExpectedArrivalTime:n.ExpectedArrivalTime,ExpectedDepartureTime:n.ExpectedDepartureTime}),!1}),Object(u.a)({},e,{results:c,loading:!1}));case"maxStopArrivalsSelection":return Object(u.a)({},e,{maxStopArrivals:t.data.maxStopArrivals});case"loading":return Object(u.a)({},e,{loading:!0});default:throw new Error}},d=Object(a.createContext)({}),f=function(e){var t=e.children,n=e.initialState,i=Object(a.useReducer)(p,n),c=Object(s.a)(i,2),o={state:c[0],dispatch:c[1]};return r.a.createElement(d.Provider,{value:o},t)},v=n(48),h=n.n(v),E=n(66),y=n(212),b=n.n(y).a.create({baseURL:"https://api.cts-strasbourg.eu/v1/siri/2.0/"}),x=function(e,t){return b.get(e,{params:t.params,auth:{username:"27fc0b07-5e85-41de-a749-338e1a00e4e8"}}).then(function(e){var n=e.data;t.dispatch({type:t.type,data:n})}).catch(function(e){alert(e)})},g=function(){var e=Object(E.a)(h.a.mark(function e(t){return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x("lines-discovery",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=Object(E.a)(h.a.mark(function e(t){return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x("estimated-timetable",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),j=n(155),D=n(188),O=n(210),R=function(){var e=Object(a.useContext)(d),t=e.state.VehicleMode,n=e.dispatch,i=function(e){return function(t){n({type:"VehicleModeFilter",data:{mode:e,checked:t.target.checked}})}};return r.a.createElement("div",null,r.a.createElement(j.a,{component:"legend"},"Type de transport"),r.a.createElement(D.a,{control:r.a.createElement(O.a,{checked:t.bus,onChange:i("bus"),value:"bus",color:"primary"}),label:"Bus"}),r.a.createElement(D.a,{control:r.a.createElement(O.a,{checked:t.tram,onChange:i("tram"),value:"tram",color:"primary"}),label:"Tram"}))},L=n(122),k=function(){var e=Object(a.useContext)(d),t=e.state,n=t.lines,i=t.line,c=t.VehicleMode,o=e.dispatch,l=n.filter(function(e){return!!c[e.RouteType]}).map(function(e){return{value:e.LineRef,label:e.RouteType+" "+e.LineRef+" - "+e.LineName}}),s=l.find(function(e){return e.value===i}),m={menu:function(e){return Object(u.a)({},e,{zIndex:999})}};return r.a.createElement("div",null,r.a.createElement(j.a,{component:"legend"},"Ligne"),r.a.createElement(L.a,{value:s,onChange:function(e){o({type:"LineSelection",data:{line:e.value}})},options:l,styles:m}))},M=function(){var e=Object(a.useContext)(d),t=e.state,n=t.stops,i=t.stop,c=t.line,o=e.dispatch,l=n.filter(function(e){return e.LineRef===c}).map(function(e){return{value:e.StopPointRef,label:e.VehicleMode+" "+e.LineRef+" - "+e.StopPointName+" => "+e.DestinationName}}),s=l.find(function(e){return e.value===i}),m={menu:function(e){return Object(u.a)({},e,{zIndex:999})}},p="";return l.length>0&&(p=r.a.createElement("div",null,r.a.createElement(j.a,{component:"legend"},"Arr\xeat"),r.a.createElement(L.a,{value:s,onChange:function(e){o({type:"StopSelection",data:{stop:e.value}})},options:l,styles:m}))),r.a.createElement("div",null,p)},w=n(223),T=n(215),C=n.n(T),V=n(175),P=n(195),A=n(193),N=n(113),I=n(114),Y=function(){var e=Object(a.useContext)(d),t=e.state,n=t.date,i=t.stop,c=e.dispatch;return null===i?r.a.createElement("div",null):r.a.createElement("div",null,r.a.createElement(j.a,{component:"legend"},"Horaire"),r.a.createElement(A.a,{container:!0,justify:"center",spacing:2},r.a.createElement(A.a,{key:"MuiPickersUtilsProvider",item:!0,xs:6},r.a.createElement(V.a,{utils:w.a,locale:C.a},r.a.createElement(V.b,{id:"mui-pickers-time",ampm:!1,variant:"inline",value:n,onChange:function(e){c({type:"DateSelection",data:{date:e}})}}))),r.a.createElement(A.a,{key:"button",item:!0,xs:6},r.a.createElement(P.a,{variant:"contained",color:"primary",onClick:function(){c({type:"DateSelection",data:{date:new Date}})}},r.a.createElement(N.a,{icon:I.b})))))},H=function(){var e=Object(E.a)(h.a.mark(function e(t){return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x("stop-monitoring",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=Object(a.useContext)(d),t=e.state,n=t.stop,i=t.date,c=t.line,o=t.maxStopArrivals,l=e.dispatch;return null===n?r.a.createElement("div",null):r.a.createElement(P.a,{variant:"contained",color:"primary",onClick:function(){l({type:"loading"}),H({dispatch:l,type:"Search",params:{MonitoringRef:n,LineRef:c,StartTime:i,MaximumStopVisits:o}})}},"Rechercher")},F=n(216),J=n.n(F),z=n(206),B=n(52),W=n.n(B),$=n(219),q=n(76),G=n(226),K=n(220),Q=n(225),X=function(e){function t(e){var n;return Object($.a)(this,t),(n=Object(G.a)(this,Object(K.a)(t).call(this,e))).dateUpdate=function(){n.setState({visibleDate:n.calculate()})},n.calculate=function(){var e=n.date.diff(W()());return e<0?n.props.finishedText:W.a.utc(e).format("HH:mm:ss")},n.date=W()(e.date),n.intervalId=null,n.state={visibleDate:n.calculate()},n}return Object(Q.a)(t,e),Object(q.a)(t,[{key:"componentDidUpdate",value:function(){this.date=W()(this.props.date)}},{key:"componentDidMount",value:function(){this.intervalId=setInterval(this.dateUpdate,1e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.intervalId)}},{key:"render",value:function(){return r.a.createElement("div",null,this.state.visibleDate)}}]),t}(a.Component),Z=function(){var e=Object(a.useContext)(d).state,t=e.results,n=e.stop,i={filter:!1,search:!1,print:!1,download:!1,viewColumns:!1,selectableRows:"none",rowsPerPage:100,customFooter:function(e,t,n,a,i){return r.a.createElement(z.a,null)}},c=t.map(function(e){return[e.VehicleMode+" "+e.LineRef,e.StopPointName,e.DestinationName,!0===e.IsRealTime?"Oui":"Non",W()(e.ExpectedArrivalTime).format("DD/MM/YYYY HH:mm:ss"),W()(e.ExpectedDepartureTime).format("DD/MM/YYYY HH:mm:ss"),r.a.createElement(X,{date:e.ExpectedArrivalTime,finishedText:"Arriv\xe9"}),r.a.createElement(X,{date:e.ExpectedDepartureTime,finishedText:"Pass\xe9"})]});return 0===t.length?null!=n?r.a.createElement("div",null,"Pas de r\xe9sultat."):r.a.createElement("div",null):r.a.createElement("div",null,r.a.createElement("br",null),r.a.createElement(J.a,{title:"Liste des horaires",data:c,columns:["Ligne","Arr\xeat","Destination","Temps r\xe9el","Arriv\xe9e","D\xe9part","Arriv\xe9e dans","D\xe9part dans"],options:i}))},_=n(307),ee=Object(_.a)(function(e){return Object(a.useContext)(d).state.loading?r.a.createElement(N.a,{icon:I.a,pulse:!0,size:"4x",color:e.theme.palette.primary.main}):r.a.createElement("div",null)}),te=n(102),ne=Object(te.a)({}),ae=n(115),re=n(194),ie=n(306),ce=Object(re.a)(function(e){return{root:{padding:e.spacing(3,2)}}}),oe=function(){var e=Object(a.useContext)(d).dispatch;Object(a.useEffect)(function(){e({type:"loading"}),g({dispatch:e,type:"setLines",params:{}}),S({dispatch:e,type:"setStops",params:{}})},[e]);var t=ce();return r.a.createElement(ae.a,{className:t.root},r.a.createElement(A.a,{container:!0,spacing:2},r.a.createElement(A.a,{item:!0,xs:12},r.a.createElement(A.a,{container:!0,justify:"center",spacing:2},r.a.createElement(A.a,{key:"VehicleModeFilter",item:!0,xs:6},r.a.createElement(R,null)),r.a.createElement(A.a,{key:"DateSelection",item:!0,xs:6},r.a.createElement(Y,null))),r.a.createElement(A.a,{container:!0,justify:"center",spacing:2},r.a.createElement(A.a,{key:"LineSelection",item:!0,xs:12},r.a.createElement(k,null))),r.a.createElement(A.a,{container:!0,justify:"center",spacing:2},r.a.createElement(A.a,{key:"LineSelection",item:!0,xs:12},r.a.createElement(M,null))),r.a.createElement(A.a,{container:!0,justify:"center",spacing:2},r.a.createElement(A.a,{key:"LineSelection",item:!0,xs:12,style:{textAlign:"center"}},r.a.createElement(U,null))),r.a.createElement(A.a,{container:!0,justify:"center",spacing:2},r.a.createElement(A.a,{key:"LineSelection",item:!0,xs:12,style:{textAlign:"center"}},r.a.createElement(ee,null))))),r.a.createElement(Z,null))},le=function(){var e={lines:[],stops:[],VehicleMode:{bus:!0,tram:!0},line:null,stop:null,date:new Date,results:[],maxStopArrivals:5,loading:!1};return r.a.createElement(ie.a,{theme:ne},r.a.createElement(f,{initialState:e},r.a.createElement(oe,null)))};var se=function(){return r.a.createElement(o.a,null,r.a.createElement(l.a,{exact:!0,path:"/",component:le}),r.a.createElement(l.a,{exact:!0,path:"/cts-2019/",component:le}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(se,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[230,1,2]]]);
//# sourceMappingURL=main.36608469.chunk.js.map